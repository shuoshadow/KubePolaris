# 全局搜索功能使用说明

## 功能概述

全局搜索功能允许用户在整个KubePolaris平台中快速查找各种Kubernetes资源，包括：

- **集群**：按集群名称搜索
- **节点**：按节点名称和IP地址搜索
- **容器组(Pod)**：按Pod名称和IP地址搜索
- **工作负载**：按Deployment、StatefulSet、DaemonSet名称搜索

## 使用方法

### 1. 访问搜索功能

- 在页面顶部的搜索框中输入关键词
- 点击搜索按钮或按回车键
- 系统会自动跳转到搜索结果页面

### 2. 搜索结果展示

搜索结果页面提供以下功能：

#### 统计概览
- 显示各类资源的搜索结果数量
- 包含集群、节点、容器组、工作负载的统计卡片

#### 分类标签
- **全部**：显示所有搜索结果
- **集群**：仅显示集群搜索结果
- **节点**：仅显示节点搜索结果
- **容器组**：仅显示Pod搜索结果
- **工作负载**：仅显示工作负载搜索结果

#### 搜索结果详情
每个搜索结果包含：
- 资源类型图标
- 资源名称
- 状态标签（带颜色区分）
- 集群信息
- 命名空间（如适用）
- IP地址（如适用）
- 其他描述信息

### 3. 跳转到详情页面

点击搜索结果中的"查看详情"按钮，系统会根据资源类型自动跳转到相应的详情页面：

- **集群** → 集群概览页面
- **节点** → 节点列表页面
- **容器组** → Pod详情页面
- **工作负载** → 工作负载详情页面

## 搜索特性

### 支持搜索的内容
- 集群名称
- 节点名称和IP地址
- Pod名称和IP地址
- 工作负载名称（Deployment、StatefulSet、DaemonSet）

### 搜索方式
- 支持模糊匹配（包含关键词即可）
- 不区分大小写
- 支持部分匹配

### 跨集群搜索
- 自动搜索所有已导入的集群
- 显示资源所属的集群信息
- 支持多集群环境下的统一搜索

## API接口

### 搜索接口
```
GET /api/v1/search?q={关键词}
```

### 响应格式
```json
{
  "code": 200,
  "message": "搜索成功",
  "data": {
    "results": [
      {
        "type": "cluster|node|pod|workload",
        "id": "资源ID",
        "name": "资源名称",
        "namespace": "命名空间（如适用）",
        "clusterId": "集群ID",
        "clusterName": "集群名称",
        "status": "资源状态",
        "description": "描述信息",
        "ip": "IP地址（如适用）",
        "kind": "资源类型（如适用）"
      }
    ],
    "total": 搜索结果总数
  }
}
```

## 技术实现

### 后端实现
- 使用Kubernetes Informer机制获取实时资源数据
- 支持多集群并发搜索
- 基于内存缓存的快速搜索

### 前端实现
- React + TypeScript + Ant Design
- 支持URL参数传递搜索关键词
- 响应式设计，支持不同屏幕尺寸

## 注意事项

1. **性能考虑**：搜索会遍历所有集群的所有资源，在大型环境中可能需要较长时间
2. **权限控制**：搜索结果基于当前用户的集群访问权限
3. **实时性**：搜索结果基于Informer缓存，可能存在轻微延迟
4. **网络依赖**：需要确保所有集群的连接正常

## 故障排除

### 常见问题

1. **搜索无结果**
   - 检查集群连接状态
   - 确认搜索关键词正确
   - 验证用户权限

2. **搜索结果不完整**
   - 检查Informer同步状态
   - 确认集群资源访问权限
   - 查看后端日志

3. **跳转失败**
   - 检查路由配置
   - 确认资源ID有效性
   - 验证集群状态

### 日志查看
- 后端日志：查看搜索处理器的日志输出
- 前端控制台：检查网络请求和错误信息
