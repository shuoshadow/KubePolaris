# Kubernetes ç®¡ç†å¹³å°

ä¸€ä¸ªåŸºäº React + Go çš„ç°ä»£åŒ– Kubernetes é›†ç¾¤ç®¡ç†å¹³å°ï¼Œæä¾›ç›´è§‚çš„ Web ç•Œé¢æ¥ç®¡ç†å’Œç›‘æ§ Kubernetes é›†ç¾¤ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æŠ€æœ¯æ ˆ

**å‰ç«¯ (k8s-management-frontend)**
- **æ¡†æ¶**: React 18 + TypeScript
- **UI ç»„ä»¶åº“**: Ant Design 5.x
- **æ„å»ºå·¥å…·**: Vite
- **çŠ¶æ€ç®¡ç†**: React Hooks
- **HTTP å®¢æˆ·ç«¯**: Axios
- **è·¯ç”±**: React Router

**åç«¯ (k8s-management-backend)**
- **è¯­è¨€**: Go 1.24
- **Web æ¡†æ¶**: Gin
- **Kubernetes å®¢æˆ·ç«¯**: client-go
- **é…ç½®ç®¡ç†**: Viper
- **æ—¥å¿—**: è‡ªå®šä¹‰æ—¥å¿—ç³»ç»Ÿ
- **è®¤è¯**: JWT (å¯é€‰)

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP/WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Kubernetes API    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                 â”‚
â”‚   React å‰ç«¯    â”‚                      â”‚   Go åç«¯       â”‚                      â”‚  Kubernetes     â”‚
â”‚                 â”‚                      â”‚                 â”‚                      â”‚  é›†ç¾¤           â”‚
â”‚  - é›†ç¾¤ç®¡ç†     â”‚                      â”‚  - API æœåŠ¡     â”‚                      â”‚                 â”‚
â”‚  - èŠ‚ç‚¹ç›‘æ§     â”‚                      â”‚  - K8s å®¢æˆ·ç«¯   â”‚                      â”‚  - API Server   â”‚
â”‚  - Pod ç®¡ç†     â”‚                      â”‚  - é›†ç¾¤å­˜å‚¨     â”‚                      â”‚  - èŠ‚ç‚¹         â”‚
â”‚  - å·¥ä½œè´Ÿè½½     â”‚                      â”‚  - å®æ—¶é€šä¿¡     â”‚                      â”‚  - Pod          â”‚
â”‚                 â”‚                      â”‚                 â”‚                      â”‚  - å·¥ä½œè´Ÿè½½     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. é›†ç¾¤ç®¡ç†
- **é›†ç¾¤å¯¼å…¥**: æ”¯æŒ kubeconfig æ–‡ä»¶å’Œæ‰‹åŠ¨é…ç½®ä¸¤ç§æ–¹å¼
- **è¿æ¥æµ‹è¯•**: å®æ—¶éªŒè¯é›†ç¾¤è¿æ¥çŠ¶æ€
- **é›†ç¾¤åˆ—è¡¨**: æ˜¾ç¤ºæ‰€æœ‰å·²å¯¼å…¥é›†ç¾¤çš„çŠ¶æ€å’ŒåŸºæœ¬ä¿¡æ¯
- **é›†ç¾¤è¯¦æƒ…**: æŸ¥çœ‹é›†ç¾¤çš„è¯¦ç»†ä¿¡æ¯å’Œèµ„æºç»Ÿè®¡

### 2. èŠ‚ç‚¹ç®¡ç†
- **èŠ‚ç‚¹åˆ—è¡¨**: æ˜¾ç¤ºé›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€
- **èŠ‚ç‚¹è¯¦æƒ…**: æŸ¥çœ‹èŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ã€èµ„æºä½¿ç”¨æƒ…å†µ
- **èŠ‚ç‚¹æ“ä½œ**: æ”¯æŒèŠ‚ç‚¹çš„å°é”(cordon)ã€è§£å°(uncordon)ã€é©±é€(drain)æ“ä½œ

### 3. Pod ç®¡ç†
- **Pod åˆ—è¡¨**: æ˜¾ç¤ºæ‰€æœ‰å‘½åç©ºé—´ä¸­çš„ Pod
- **Pod è¯¦æƒ…**: æŸ¥çœ‹ Pod çš„è¯¦ç»†ä¿¡æ¯ã€å®¹å™¨çŠ¶æ€
- **æ—¥å¿—æŸ¥çœ‹**: å®æ—¶æŸ¥çœ‹ Pod å’Œå®¹å™¨æ—¥å¿—
- **ç»ˆç«¯è®¿é—®**: é€šè¿‡ WebSocket è¿æ¥åˆ° Pod å®¹å™¨

### 4. å·¥ä½œè´Ÿè½½ç®¡ç†
- **å¤šç±»å‹æ”¯æŒ**: Deploymentã€StatefulSetã€DaemonSet ç­‰
- **å·¥ä½œè´Ÿè½½åˆ—è¡¨**: æ˜¾ç¤ºæ‰€æœ‰å·¥ä½œè´Ÿè½½çš„çŠ¶æ€
- **æ‰©ç¼©å®¹æ“ä½œ**: åŠ¨æ€è°ƒæ•´å·¥ä½œè´Ÿè½½çš„å‰¯æœ¬æ•°
- **YAML åº”ç”¨**: æ”¯æŒç›´æ¥åº”ç”¨ YAML é…ç½®

### 5. å…¨å±€æœç´¢
- **è·¨èµ„æºæœç´¢**: åœ¨æ‰€æœ‰é›†ç¾¤ä¸­æœç´¢èµ„æº
- **æ™ºèƒ½è¿‡æ»¤**: æ”¯æŒæŒ‰ç±»å‹ã€å‘½åç©ºé—´ã€æ ‡ç­¾è¿‡æ»¤
- **å¿«é€Ÿå®šä½**: å¿«é€Ÿæ‰¾åˆ°ç›®æ ‡èµ„æº

### 6. ç»ˆç«¯å’Œå®¡è®¡
- **Web ç»ˆç«¯**: ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®é›†ç¾¤ã€èŠ‚ç‚¹ã€Pod
- **æ“ä½œå®¡è®¡**: è®°å½•æ‰€æœ‰ç»ˆç«¯æ“ä½œå’Œå‘½ä»¤å†å²
- **ä¼šè¯ç®¡ç†**: ç®¡ç†å’ŒæŸ¥çœ‹ç»ˆç«¯ä¼šè¯

## ğŸ“ é¡¹ç›®ç»“æ„

```
k8s-management-platform/
â”œâ”€â”€ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ plan.md                           # å¼€å‘è®¡åˆ’
â”œâ”€â”€ task-list.md                      # ä»»åŠ¡æ¸…å•
â”œâ”€â”€ prototypes/                       # åŸå‹è®¾è®¡
â”‚   â”œâ”€â”€ components/                   # ç»„ä»¶åŸå‹
â”‚   â”œâ”€â”€ layouts/                      # å¸ƒå±€åŸå‹
â”‚   â”œâ”€â”€ pages/                        # é¡µé¢åŸå‹
â”‚   â””â”€â”€ html/                         # HTML åŸå‹
â”œâ”€â”€ k8s-management-frontend/          # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/               # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layouts/                  # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/                    # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ cluster/              # é›†ç¾¤ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ node/                 # èŠ‚ç‚¹ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ pod/                  # Pod ç®¡ç†é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ workload/             # å·¥ä½œè´Ÿè½½é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ search/               # æœç´¢é¡µé¢
â”‚   â”‚   â”œâ”€â”€ services/                 # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ types/                    # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â””â”€â”€ k8s-management-backend/           # åç«¯é¡¹ç›®
    â”œâ”€â”€ main.go                       # ç¨‹åºå…¥å£
    â”œâ”€â”€ configs/                      # é…ç½®æ–‡ä»¶
    â”œâ”€â”€ internal/
    â”‚   â”œâ”€â”€ config/                   # é…ç½®ç®¡ç†
    â”‚   â”œâ”€â”€ database/                 # æ•°æ®åº“è¿æ¥
    â”‚   â”œâ”€â”€ handlers/                 # HTTP å¤„ç†å™¨
    â”‚   â”‚   â”œâ”€â”€ cluster.go            # é›†ç¾¤ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ node.go               # èŠ‚ç‚¹ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ pod.go                # Pod ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ workload.go           # å·¥ä½œè´Ÿè½½ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ search.go             # æœç´¢åŠŸèƒ½
    â”‚   â”‚   â”œâ”€â”€ terminal.go           # ç»ˆç«¯åŠŸèƒ½
    â”‚   â”‚   â””â”€â”€ audit.go              # å®¡è®¡åŠŸèƒ½
    â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶
    â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
    â”‚   â”œâ”€â”€ router/                   # è·¯ç”±é…ç½®
    â”‚   â””â”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡
    â”‚       â”œâ”€â”€ k8s_client.go         # Kubernetes å®¢æˆ·ç«¯
    â”‚       â””â”€â”€ cluster_store.go      # é›†ç¾¤å­˜å‚¨æœåŠ¡
    â”œâ”€â”€ pkg/
    â”‚   â””â”€â”€ logger/                   # æ—¥å¿—ç³»ç»Ÿ
    â”œâ”€â”€ go.mod
    â””â”€â”€ go.sum
```

## ğŸ”§ æ ¸å¿ƒæœåŠ¡

### Kubernetes å®¢æˆ·ç«¯æœåŠ¡ (k8s_client.go)
- **å¤šç§è¿æ¥æ–¹å¼**: æ”¯æŒ kubeconfig å’Œ Token ä¸¤ç§è®¤è¯æ–¹å¼
- **è¿æ¥æµ‹è¯•**: éªŒè¯é›†ç¾¤è¿æ¥å¹¶è·å–åŸºæœ¬ä¿¡æ¯
- **èµ„æºæ“ä½œ**: æä¾›å¯¹ Kubernetes èµ„æºçš„ CRUD æ“ä½œ
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œè¶…æ—¶æœºåˆ¶

### é›†ç¾¤å­˜å‚¨æœåŠ¡ (cluster_store.go)
- **å†…å­˜å­˜å‚¨**: é«˜æ€§èƒ½çš„å†…å­˜å­˜å‚¨ï¼Œæ”¯æŒå¹¶å‘è®¿é—®
- **çŠ¶æ€ç®¡ç†**: è‡ªåŠ¨æ›´æ–°å’Œç»´æŠ¤é›†ç¾¤çŠ¶æ€
- **ç»Ÿè®¡ä¿¡æ¯**: æä¾›é›†ç¾¤ç»Ÿè®¡å’Œå¥åº·çŠ¶æ€ç›‘æ§
- **æ‰©å±•æ€§**: å¯è½»æ¾æ‰©å±•ä¸ºæ•°æ®åº“å­˜å‚¨

## ğŸŒ API æ¥å£

### é›†ç¾¤ç®¡ç† API
```
GET    /api/clusters                    # è·å–é›†ç¾¤åˆ—è¡¨
POST   /api/clusters/import             # å¯¼å…¥é›†ç¾¤
GET    /api/clusters/:id                # è·å–é›†ç¾¤è¯¦æƒ…
DELETE /api/clusters/:id                # åˆ é™¤é›†ç¾¤
GET    /api/clusters/stats              # è·å–é›†ç¾¤ç»Ÿè®¡
POST   /api/clusters/test-connection    # æµ‹è¯•é›†ç¾¤è¿æ¥
GET    /api/clusters/:id/overview       # è·å–é›†ç¾¤æ¦‚è§ˆ
GET    /api/clusters/:id/metrics        # è·å–é›†ç¾¤ç›‘æ§æ•°æ®
```

### èŠ‚ç‚¹ç®¡ç† API
```
GET    /api/clusters/:id/nodes          # è·å–èŠ‚ç‚¹åˆ—è¡¨
GET    /api/clusters/:id/nodes/:name    # è·å–èŠ‚ç‚¹è¯¦æƒ…
POST   /api/clusters/:id/nodes/:name/cordon    # å°é”èŠ‚ç‚¹
POST   /api/clusters/:id/nodes/:name/uncordon  # è§£å°èŠ‚ç‚¹
POST   /api/clusters/:id/nodes/:name/drain     # é©±é€èŠ‚ç‚¹
```

### Pod ç®¡ç† API
```
GET    /api/clusters/:id/pods                      # è·å– Pod åˆ—è¡¨
GET    /api/clusters/:id/pods/:namespace/:name     # è·å– Pod è¯¦æƒ…
GET    /api/clusters/:id/pods/:namespace/:name/logs # è·å– Pod æ—¥å¿—
```

### WebSocket ç»ˆç«¯ API
```
GET    /ws/clusters/:id/terminal                           # é›†ç¾¤ç»ˆç«¯
GET    /ws/clusters/:id/nodes/:name/terminal               # èŠ‚ç‚¹ç»ˆç«¯
GET    /ws/clusters/:id/pods/:namespace/:name/terminal     # Pod ç»ˆç«¯
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- Go 1.24+
- æœ‰æ•ˆçš„ Kubernetes é›†ç¾¤è®¿é—®æƒé™

### å¯åŠ¨å‰ç«¯æœåŠ¡
```bash
cd k8s-management-frontend
npm install
npm run dev
# è®¿é—® http://localhost:5173
```

### å¯åŠ¨åç«¯æœåŠ¡
```bash
cd k8s-management-backend
go mod tidy
go run main.go
# æœåŠ¡è¿è¡Œåœ¨ http://localhost:8080
```

### ä½¿ç”¨è¯´æ˜
1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`
2. ç‚¹å‡»"å¯¼å…¥é›†ç¾¤"æŒ‰é’®
3. é€‰æ‹©è¿æ¥æ–¹å¼ï¼š
   - **kubeconfig æ–‡ä»¶**: ç²˜è´´å®Œæ•´çš„ kubeconfig å†…å®¹
   - **æ‰‹åŠ¨é…ç½®**: å¡«å†™ API Server åœ°å€å’Œè®¿é—®ä»¤ç‰Œ
4. ç‚¹å‡»"æµ‹è¯•è¿æ¥"éªŒè¯é›†ç¾¤è¿æ¥
5. è¿æ¥æˆåŠŸåç‚¹å‡»"å¯¼å…¥é›†ç¾¤"å®Œæˆå¯¼å…¥
6. åœ¨é›†ç¾¤åˆ—è¡¨ä¸­æŸ¥çœ‹å’Œç®¡ç†å·²å¯¼å…¥çš„é›†ç¾¤

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **è®¤è¯æ”¯æŒ**: æ”¯æŒ JWT è®¤è¯ï¼ˆå¯é€‰å¯ç”¨ï¼‰
- **HTTPS æ”¯æŒ**: æ”¯æŒ TLS åŠ å¯†é€šä¿¡
- **æƒé™æ§åˆ¶**: åŸºäº Kubernetes RBAC çš„æƒé™ç®¡ç†
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œå®¡è®¡å’Œæ—¥å¿—è®°å½•

## ğŸ¯ ç‰¹è‰²åŠŸèƒ½

### 1. çœŸå®é›†ç¾¤è¿æ¥
- ä¸ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œç›´æ¥è¿æ¥çœŸå®çš„ Kubernetes é›†ç¾¤
- å®æ—¶è·å–é›†ç¾¤çŠ¶æ€å’Œèµ„æºä¿¡æ¯
- æ”¯æŒå¤šé›†ç¾¤ç®¡ç†

### 2. ç°ä»£åŒ–ç•Œé¢
- åŸºäº Ant Design çš„ç°ä»£åŒ– UI
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯è®¿é—®
- ç›´è§‚çš„æ“ä½œç•Œé¢å’Œä¸°å¯Œçš„äº¤äº’ä½“éªŒ

### 3. å®æ—¶é€šä¿¡
- WebSocket æ”¯æŒå®æ—¶ç»ˆç«¯è®¿é—®
- å®æ—¶æ—¥å¿—æµæ˜¾ç¤º
- é›†ç¾¤çŠ¶æ€å®æ—¶æ›´æ–°

### 4. é«˜æ€§èƒ½æ¶æ„
- Go è¯­è¨€é«˜æ€§èƒ½åç«¯
- React å‰ç«¯ä¼˜åŒ–
- å†…å­˜å­˜å‚¨æä¾›å¿«é€Ÿå“åº”

## ğŸ“ˆ æœªæ¥è§„åˆ’

- [ ] æ•°æ®åº“æŒä¹…åŒ–å­˜å‚¨
- [ ] ç”¨æˆ·æƒé™ç®¡ç†ç³»ç»Ÿ
- [ ] é›†ç¾¤ç›‘æ§å’Œå‘Šè­¦
- [ ] èµ„æºé…é¢ç®¡ç†
- [ ] Helm åº”ç”¨ç®¡ç†
- [ ] CI/CD é›†æˆ
- [ ] å¤šç§Ÿæˆ·æ”¯æŒ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥å¸®åŠ©æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚